<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Worksheet 3</title>
</head>

<body onload="main()">
    <canvas id="webgl" width="900" height="600">
        Please use a browser that supports "canvas"
    </canvas>
    <div class="menu">
        <select id="materialSelector">
            <option value="gold">Gold</option>
            <option value="emerald">Emerald</option>
            <option value="perl">Perl</option>
            <option value="obsidian">Obsidian</option>
        </select>
    </div>

    <script type="x-shader/x-vertex" id="vertex-shader">
    attribute vec4 a_Position;
    attribute vec4 a_Normal;
    varying vec4 v_Color;

    uniform mat4 u_MvpMatrix;
    uniform mat4 u_NormalMatrix;
    
    uniform vec4 ambientProduct, diffuseProduct, specularProduct;
    uniform vec4 lightPosition;
    uniform float shininess;
    void main() {
        gl_Position = u_MvpMatrix * a_Position;
        // Shading calculation to make the arm look three-dimensional
       
        vec3 pos = -(u_MvpMatrix * a_Position).xyz;
        vec3 E = normalize( -pos );
        vec3 L = normalize(lightPosition.xyz); // Light direction
        vec3 N = normalize((u_NormalMatrix * a_Normal).xyz);
        vec3 H = normalize(L + E);
        
        vec4 ambient = ambientProduct;

        float Kd = max(dot(N, L), 0.0);
        vec4  diffuse = Kd*diffuseProduct;

        float Ks = pow( max(dot(N, H), 0.0), shininess );
        vec4  specular = Ks * specularProduct;

        if( dot(L, N) < 0.0 ) {
            specular = vec4(0.0, 0.0, 0.0, 1.0);
        } 

        v_Color = ambient + diffuse +specular;
        v_Color.a = 1.0;
      }
    </script>
    <script type="x-shader/x-fragment" id="fragment-shader">
    precision mediump float;
    varying vec4 v_Color;
    void main() {
        gl_FragColor = v_Color;
    }
    </script>
    <script type="text/javascript" src="Common/webgl-utils.js"></script>
    <script type="text/javascript" src="Common/initShaders.js"></script>
    <script type="text/javascript" src="Common/MV.js"></script>
    <script type="text/javascript" src="Common/cuon-matrix.js"></script>
    <script type="text/javascript" src="ws3.js"></script>
</body>

</html>